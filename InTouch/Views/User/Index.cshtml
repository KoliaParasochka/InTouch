@using ProjectDb.Entities
@model Message
@{
    ViewBag.Title = "Index";
}

<div class="container">
    <div class="messages">
        @foreach (var el in ViewBag.Messages)
        {
            if (string.IsNullOrEmpty(el.ImgPath))
            {
                <div class="col-md-11">
                    <p>
                        @el.Text
                    </p>
                </div>
            }
            else
            {
                <div class="col-md-11">
                    <img class="img-size" src="@Url.Content(el.ImgPath)" />
                </div>
            }

            if (ViewBag.Time < el.TimeToDelete)
            {
                <div class="col-md-1">
                    @using (Html.BeginForm("DeleteMessage", "User", FormMethod.Post))
                    {
                        <input type="hidden" name="id" value="@el.Id" />
                        <input type="submit" value="Удалить" class="btn btn-danger" />
                    }
                </div>
            }
        }
    </div>
    @using (Html.BeginForm("Upload", "User", FormMethod.Post, new { enctype = "multipart/form-data" }))
    {
        <input type="file" name="upload" /><br>
        <input type="submit" value="Загрузить" class="btn btn-default" />
    }
    <br />
    @using (Html.BeginForm("SendMessage", "User", FormMethod.Post, new { @class = "form-horizontal", role = "form" }))
    {
        @Html.AntiForgeryToken()
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })
        <div class="form-group">
            <div class="col-md-12">
                @Html.TextAreaFor(m => m.Text, new { @class = "form-control", @placeholder = "Введите ваше сообщение..." })
                @Html.ValidationMessageFor(m => m.Text, "", new { @class = "text-danger" })
            </div>
        </div>
        <div class="form-group">
            <div class="col-md-offset-0 col-md-10">
                <input type="submit" class="btn btn-primary" value="Отправить" />
            </div>
        </div>
    }

</div>

